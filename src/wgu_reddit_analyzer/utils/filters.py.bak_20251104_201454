def filter_by_course_exact(df, text_col="text", course_codes=None):
    if not course_codes:
        return df
    import re
    pat = re.compile(r"\b(" + "|".join(map(re.escape, course_codes)) + r")\b", flags=re.I)
    return df[df[text_col].fillna("").str.contains(pat)]

def filter_by_vader(df, score_col="vader_compound", threshold=-0.2):
    if score_col not in df.columns:
        return df
    return df[df[score_col] <= threshold]
